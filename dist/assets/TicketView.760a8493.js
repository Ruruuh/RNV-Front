import{_ as z,d as M,H as L,s as I,u as oe,o as n,c as _,a as e,t as w,q as t,F as S,p as U,e as V,g as E,r as q,C as A,x as j,j as f,h as ue,m as X,I as me,i as K,v as Q,A as W,b as x,w as P,T as ve,f as J,J as pe,n as he,y as be}from"./index.af7eaf7e.js";import{n as D}from"./nprogress.af06dfa6.js";const B=a=>(U("data-v-583502b3"),a=a(),V(),a),ke={class:"ticket__header"},fe={class:"ticket__title"},ge=B(()=>e("div",{class:"ticket__back-icon"},null,-1)),we=B(()=>e("div",{class:"ticket__back-copy"},"go back",-1)),ye=[ge,we],$e=B(()=>e("div",{class:"ticket__divider"},null,-1)),Ie={class:"ticket__info"},xe={class:"ticket__row"},Te=B(()=>e("div",{class:"ticket__label"},"First Name",-1)),Se={class:"ticket__firstName"},Re={class:"ticket__row"},Be=B(()=>e("div",{class:"ticket__label"},"Last Name",-1)),Ne={class:"ticket__lastName"},Ce={class:"ticket__row"},Ae=B(()=>e("div",{class:"ticket__label"},"Date",-1)),je={class:"ticket__date"},ze={class:"ticket__row"},Me=B(()=>e("div",{class:"ticket__label"},"Purpose",-1)),Le={class:"ticket__purpose"},Ue={class:"ticket__row"},Ve=B(()=>e("div",{class:"ticket__label"},"Office",-1)),De={class:"ticket__office"},Pe={class:"ticket__row"},qe=B(()=>e("div",{class:"ticket__label"},"Department",-1)),Ee={class:"ticket__office"},Fe=M({__name:"TicketInfo",setup(a){const y=L(),{ticket:s}=I(y),c=oe();function p(){c.go(-1)}return(l,m)=>{var d,r,h,g,i,o,$;return n(),_(S,null,[e("div",ke,[e("div",fe,"Ticket CRF # "+w((d=t(s))==null?void 0:d.crf),1),e("div",{onClick:p,class:"ticket__back"},ye)]),$e,e("div",Ie,[e("div",xe,[Te,e("div",Se,w((r=t(s))==null?void 0:r.creatorInfo.firstName),1)]),e("div",Re,[Be,e("div",Ne,w((h=t(s))==null?void 0:h.creatorInfo.lastName),1)]),e("div",Ce,[Ae,e("div",je,w((g=t(s))==null?void 0:g.createdAt.toString().slice(0,10)),1)]),e("div",ze,[Me,e("div",Le,w((i=t(s))==null?void 0:i.purpose),1)]),e("div",Ue,[Ve,e("div",De,w((o=t(s))==null?void 0:o.office),1)]),e("div",Pe,[qe,e("div",Ee,w(($=t(s))==null?void 0:$.department),1)])])],64)}}});var He=z(Fe,[["__scopeId","data-v-583502b3"]]);const ne=a=>(U("data-v-5d7aeb44"),a=a(),V(),a),Oe={class:"reimbursement"},Ge=ne(()=>e("div",{class:"reimbursement__header"},[e("div",{class:"reimbursement__title"},"Reimbursement")],-1)),Je=ne(()=>e("div",{class:"reimbursement__table"},[e("div",{class:"reimbursement__column-headers"},[e("div",null,"Row #"),e("div",null,"Date"),e("div",null,"Amount"),e("div",null,"Nature of Expenditure"),e("div",null,"Approve")])],-1)),Ke={class:"reimbursement__total"},Qe={class:"reimbursement__amount"},We={class:"reimbursement__total"},Xe={class:"reimbursement__amount"},Ye={key:0,class:"reimbursement__note"},Ze=M({__name:"TicketReimbursement",setup(a){const y=E(),s=L(),{role:c}=I(y),{ticket:p,reimbursementTotal:l,approvedReimbursementTotal:m}=I(s);return(d,r)=>{var g;const h=q("base-row");return n(),_("div",Oe,[Ge,Je,(n(!0),_(S,null,A((g=t(p))==null?void 0:g.reimbursements,i=>(n(),j(h,{onUpdateApprovedRows:r[0]||(r[0]=o=>t(s).updateApprovedRows(o)),class:"reimbursement__row",key:i.rowNumber,reimbursementId:i.id,rowNumber:i.rowNumber,date:i.expenseDate,amount:i.expenseAmount,nature:i.expenseNature,approved:i.approved,mode:"ticket"},null,8,["reimbursementId","rowNumber","date","amount","nature","approved"]))),128)),e("div",Ke,[e("div",Qe,"Total Amount: "+w(t(l)),1)]),e("div",We,[e("div",Xe,"Total Approved Amount: "+w(t(m)),1),t(c)!=="user"?(n(),_("div",Ye,"* If ticket is saved while total approved is below 500, it will be rejected.")):f("",!0)])])}}});var et=z(Ze,[["__scopeId","data-v-5d7aeb44"]]);const ce=a=>(U("data-v-90b05cb4"),a=a(),V(),a),tt={class:"uploads"},at=ce(()=>e("div",{class:"uploads__header"},"Uploaded Receipt/Prescription",-1)),st={class:"uploads__carousel"},ot=["src"],nt={class:"uploads__controls"},ct={class:"uploads__indicators"},rt=ce(()=>e("div",{class:"uploads__icon-right"},null,-1)),it=[rt],lt=M({__name:"TicketUploads",setup(a){const y=L(),{ticket:s}=I(y),c=ue(0),p=X(()=>{var r;const d=(r=s.value)==null?void 0:r.images;return d?d[c.value].link:""});function l(){var d;c.value+1===((d=s.value)==null?void 0:d.images.length)?c.value=0:c.value+=1}function m(){var d;c.value-1===-1?(d=s.value)!=null&&d.images&&(c.value=s.value.images.length-1):c.value-=1}return(d,r)=>{var h;return n(),_("div",tt,[at,e("div",st,[e("img",{src:t(p),class:"uploads__img"},null,8,ot),e("div",nt,[e("div",{class:"uploads__left"},[e("div",{onClick:m,class:"uploads__icon-left"})]),e("div",ct,[(n(!0),_(S,null,A((h=t(s))==null?void 0:h.images,(g,i)=>(n(),_("div",{class:me(i===c.value?"dark":"light")},null,2))),256))]),e("div",{onClick:l,class:"uploads__right"},it)])])])}}});var dt=z(lt,[["__scopeId","data-v-90b05cb4"]]);const R=a=>(U("data-v-7ed712c8"),a=a(),V(),a),_t={key:0,class:"balance"},ut=R(()=>e("div",{class:"balance__header"},"Balance Info",-1)),mt={class:"balance__row"},vt=R(()=>e("div",{class:"balance__label"},"Name",-1)),pt={class:"balance__name"},ht={class:"balance__row"},bt=R(()=>e("div",{class:"balance__label"},"Balance",-1)),kt={class:"balance__balance"},ft={class:"balance__row"},gt=R(()=>e("div",{class:"balance__label"},"Amount",-1)),wt={class:"balance__amount"},yt={class:"balance__row"},$t=R(()=>e("div",{class:"balance__label"},"Prepared By",-1)),It={class:"balance__prepared"},xt={key:1,class:"balance"},Tt=R(()=>e("div",{class:"balance__header"},"Balance Info",-1)),St={class:"balance__row"},Rt=R(()=>e("div",{class:"balance__label"},"Name",-1)),Bt={class:"balance__name"},Nt={class:"balance__row"},Ct=R(()=>e("div",{class:"balance__label"},"Balance",-1)),At={class:"balance__row"},jt=R(()=>e("div",{class:"balance__label"},"Amount",-1)),zt={class:"balance__row"},Mt=R(()=>e("div",{class:"balance__label"},"Prepared By",-1)),Lt={key:0,class:"error"},Ut=M({__name:"TicketBalance",setup(a){const y=E(),s=L(),{role:c,overview:p}=I(y),{ticket:l,balance:m,amount:d,preparedBy:r,isBalanceEmpty:h}=I(s),g=X(()=>{var b,C;const i=(b=l.value)==null?void 0:b.creatorInfo.firstName,o=(C=l.value)==null?void 0:C.creatorInfo.lastName;return i+" "+o});return(i,o)=>{var $;return n(),_(S,null,[($=t(l))!=null&&$.balance?(n(),_("div",_t,[ut,e("div",mt,[vt,e("div",pt,w(t(g)),1)]),e("div",ht,[bt,e("div",kt,w(t(l).balance.balance),1)]),e("div",ft,[gt,e("div",wt,w(t(l).balance.amount),1)]),e("div",yt,[$t,e("div",It,w(t(l).balance.preparedBy),1)])])):f("",!0),t(c)==="hr"&&t(p)==="pending"?(n(),_("div",xt,[Tt,e("div",St,[Rt,e("div",Bt,w(t(g)),1)]),e("div",Nt,[Ct,K(e("input",{type:"number","onUpdate:modelValue":o[0]||(o[0]=b=>W(m)?m.value=b:null),required:""},null,512),[[Q,t(m)]])]),e("div",At,[jt,K(e("input",{type:"number","onUpdate:modelValue":o[1]||(o[1]=b=>W(d)?d.value=b:null),required:""},null,512),[[Q,t(d)]])]),e("div",zt,[Mt,K(e("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=b=>W(r)?r.value=b:null),required:""},null,512),[[Q,t(r)]])]),t(h)?(n(),_("div",Lt,"Please fill up all balance fields.")):f("",!0)])):f("",!0)],64)}}});var Vt=z(Ut,[["__scopeId","data-v-7ed712c8"]]);const N=a=>(U("data-v-647ce483"),a=a(),V(),a),Dt={key:0,class:"remarks"},Pt=N(()=>e("div",{class:"remarks__header"},"Remarks",-1)),qt={class:"remarks__user"},Et={key:1,class:"remarks__other"},Ft=N(()=>e("div",{class:"remarks__header"},"Remarks",-1)),Ht=N(()=>e("div",{class:"remarks__copy"},"These are feedback that will be seen by the user.",-1)),Ot={class:"remarks__public"},Gt=N(()=>e("div",{class:"remarks__header"},"Internal Comments",-1)),Jt=N(()=>e("div",{class:"remarks__copy"},"These are feedback that will only be seen by admins.",-1)),Kt={class:"remarks__private"},Qt={key:0,class:"error"},Wt={key:2,class:"remarks__other"},Xt=N(()=>e("div",{class:"remarks__header"},"Remarks",-1)),Yt=N(()=>e("div",{class:"remarks__copy"},"These are feedback that will be seen by the user.",-1)),Zt={class:"remarks__public"},ea=N(()=>e("div",{class:"remarks__header"},"Internal Comments",-1)),ta=N(()=>e("div",{class:"remarks__copy"},"These are feedback that will only be seen by the admins.",-1)),aa={class:"remarks__private"},sa=M({__name:"TicketRemarks",setup(a){const y=E(),s=L(),{role:c,overview:p}=I(y),{isInputBlank:l,publicFeedback:m,privateFeedback:d}=I(s),r=["director","hsu","hr","sdas","finance"];return(h,g)=>{const i=q("base-remark");return n(),_(S,null,[t(c)==="user"?(n(),_("div",Dt,[Pt,e("div",qt,[(n(),_(S,null,A(r,o=>x(i,{roleListItem:o,content:t(m)[o]},null,8,["roleListItem","content"])),64))])])):f("",!0),t(p)==="pending"?(n(),_("div",Et,[Ft,Ht,e("div",Ot,[(n(),_(S,null,A(r,o=>x(i,{roleListItem:o,content:t(m)[o],type:"public"},null,8,["roleListItem","content"])),64))]),Gt,Jt,e("div",Kt,[(n(),_(S,null,A(r,o=>x(i,{roleListItem:o,content:t(d)[o],type:"private"},null,8,["roleListItem","content"])),64))]),t(l)?(n(),_("div",Qt,"Remarks and internal comments cannot be empty. Please update.")):f("",!0)])):f("",!0),t(p)==="completed"?(n(),_("div",Wt,[Xt,Yt,e("div",Zt,[(n(),_(S,null,A(r,o=>x(i,{roleListItem:o,content:t(m)[o],type:"public"},null,8,["roleListItem","content"])),64))]),ea,ta,e("div",aa,[(n(),_(S,null,A(r,o=>x(i,{roleListItem:o,content:t(d)[o],type:"private"},null,8,["roleListItem","content"])),64))])])):f("",!0)],64)}}});var oa=z(sa,[["__scopeId","data-v-647ce483"]]);const F=a=>(U("data-v-d632275c"),a=a(),V(),a),na=F(()=>e("div",{class:"modal__title"},"Confirmation",-1)),ca=F(()=>e("div",{class:"modal__divider"},null,-1)),ra={class:"modal__content"},ia=F(()=>e("div",null,"Hey, there.",-1)),la=F(()=>e("div",null,"The changes from this action is not reversible.",-1)),da={key:0},_a={key:1},ua=F(()=>e("div",null,"Done double checking? Please click below.",-1)),ma=J("Save"),va=J("Reject"),pa=M({__name:"TicketModal",setup(a){const y=E(),s=L(),{role:c,token:p}=I(y),{ticket:l,approvedRows:m,approvedReimbursementTotal:d,publicRemarksInput:r,privateRemarksInput:h,isModalShown:g,balance:i,amount:o,preparedBy:$,mode:b}=I(s),C=oe();function Y(){var T;const u=["director","hsu","hr","sdas","finance","none"];let k=u.indexOf(c.value),v="";return((T=m.value)==null?void 0:T.length)===0||d.value<500?v="none":v=u[k+1],v}function re(){var k;const u=(k=l.value)==null?void 0:k.reimbursements;return u==null||u.forEach(v=>{var T;(T=m.value)!=null&&T.includes(v.id)?v.approved=!0:v.approved=!1}),u}function ie(){var H,O,G;const u=(H=l.value)==null?void 0:H.creatorInfo.firstName,k=(O=l.value)==null?void 0:O.creatorInfo.lastName,v=u+" "+k;return{ticketId:(G=l.value)==null?void 0:G.id,name:v,balance:i.value,amount:o.value,preparedBy:$.value}}function le(){var v;let u="";const k=Y();return((v=m.value)==null?void 0:v.length)===0||d.value<500?u="Rejected":k==="none"?u="Completed":k==="hsu"?u="Director Approved":k==="hr"?u="HSU Approved":k==="sdas"?u="HR Approved":k==="finance"&&(u="SDAS Approved"),u}async function Z(){var ee,te,ae,se;if(D.start(),c.value==="hr")if(!i.value||!o.value||!$.value){s.updateIsBalanceEmpty(),s.updateIsModalShown(),D.done();return}else s.updateIsBalanceEmpty();if(r.value===""||h.value===""){s.updateIsInputBlank(),s.updateIsModalShown(),D.done();return}else s.updateIsInputBlank();const u="/api/tickets/"+((ee=l.value)==null?void 0:ee.crf),k=Y(),v=le(),T=re(),H=ie(),O=[{ticketId:(te=l.value)==null?void 0:te.id,type:"public",role:c.value,content:r.value},{ticketId:(ae=l.value)==null?void 0:ae.id,type:"private",role:c.value,content:h.value}],G={ticketId:(se=l.value)==null?void 0:se.id,actionBy:k,status:v,reimbursements:T,remarks:O,balance:H};await pe(u,p.value,G),r.value="",h.value="",s.updateIsModalShown(),D.done(),C.push("/overview/pending")}async function de(){m.value=[],s.updateIsModalShown(),await Z()}function _e(){s.updateIsModalShown()}return(u,k)=>{const v=q("base-button"),T=q("base-modal");return n(),j(ve,{to:"#app"},[t(g)?(n(),j(T,{key:0},{default:P(()=>[e("div",{class:"modal__header"},[na,e("div",{onClick:_e,class:"modal__close"})]),ca,e("div",ra,[ia,la,t(b)==="update"?(n(),_("div",da,"Before saving, please check if everything is correct.")):f("",!0),t(b)==="reject"?(n(),_("div",_a,"Before rejecting, please check if everything is correct.")):f("",!0),ua]),t(b)==="update"?(n(),j(v,{key:0,onClick:Z,mode:"darkSmall"},{default:P(()=>[ma]),_:1})):f("",!0),t(b)==="reject"?(n(),j(v,{key:1,onClick:de,mode:"redSmall"},{default:P(()=>[va]),_:1})):f("",!0)]),_:1})):f("",!0)])}}});var ha=z(pa,[["__scopeId","data-v-d632275c"]]);const ba=a=>(U("data-v-1f847560"),a=a(),V(),a),ka={class:"ticket"},fa=J("Save"),ga=ba(()=>e("div",{class:"ticket__divider"},null,-1)),wa=J("Reject"),ya=M({__name:"TicketView",props:["ticketCrf"],setup(a){const y=a,s=E(),c=L(),{role:p,overview:l,token:m}=I(s),{ticket:d,mode:r}=I(c);async function h(){D.start();const $="/api/tickets/"+y.ticketCrf.toString(),b=await be($,m.value);d.value=b,c.updateRowNumbers(),c.updateReimbursementTotal(),c.updateApprovedReimbursementTotal(),c.getApprovedRows(),c.getRemarks(),D.done()}const g=X(()=>p.value==="user"?!1:l.value!=="completed");function i(){r.value="update",c.updateIsModalShown()}function o(){r.value="reject",c.updateIsModalShown()}return he(()=>{h()}),($,b)=>{const C=q("base-button");return n(),_("section",ka,[x(He),x(et),x(dt),x(Vt),x(oa),x(ha),t(g)?(n(),j(C,{key:0,onClick:i,mode:"dark"},{default:P(()=>[fa]),_:1})):f("",!0),ga,t(p)!=="user"&&t(p)!=="hr"&&t(l)!=="completed"?(n(),j(C,{key:1,onClick:o,mode:"red"},{default:P(()=>[wa]),_:1})):f("",!0)])}}});var xa=z(ya,[["__scopeId","data-v-1f847560"]]);export{xa as default};
